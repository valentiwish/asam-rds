import{V as t}from"./vendor.c9c7349a.js";!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(o){const n=new URL(t,location),s=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((o,a)=>{const i=new URL(t,n);if(self[e].moduleMap[i])return o(self[e].moduleMap[i]);const r=new Blob([`import * as m from '${i}';`,`${e}.moduleMap['${i}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){a(new Error(`Failed to import: ${t}`)),s(c)},onload(){o(self[e].moduleMap[i]),s(c)}});document.head.appendChild(c)})),self[e].moduleMap={}}}("static/");var e=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"login-wrap"},[o("div",{staticClass:"content"},[o("div",{staticClass:"logincontent",attrs:{id:"logincontent"}},[o("img",{staticStyle:{width:"220px"},attrs:{src:"/sysconf/source/sys-logo-1.png"}}),t.errorInfo.show?o("div",{staticClass:"animated headShake",staticStyle:{"text-align":"center","padding-top":"80px"}},[o("div",{staticStyle:{"font-size":"26px"}},[t._v(t._s(t.errorInfo.title))]),o("div",{domProps:{innerHTML:t._s(t.errorInfo.content)}})]):[o("div",{staticClass:"title"},[t._v("统一认证中心")]),o("div",{staticClass:"accountlogin"},[o("div",{staticClass:"main"},[o("div",{staticClass:"inputitem"},[o("img",{attrs:{src:"./images/ua.png",alt:""}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.userInfo.username,expression:"userInfo.username",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:t.userInfo.username},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loginAction()},input:function(e){e.target.composing||t.$set(t.userInfo,"username",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),o("div",{staticClass:"inputitem"},[o("img",{attrs:{src:"./images/pw.png",alt:""}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.userInfo.password,expression:"userInfo.password",modifiers:{trim:!0}}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:t.userInfo.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loginAction()},input:function(e){e.target.composing||t.$set(t.userInfo,"password",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.checkcode,expression:"userInfo.checkcode"}],attrs:{type:"text",placeholder:"请输入右侧验证码"},domProps:{value:t.userInfo.checkcode},on:{input:function(e){e.target.composing||t.$set(t.userInfo,"checkcode",e.target.value)}}}),o("img",{staticStyle:{"vertical-align":"middle","margin-left":"3px"},attrs:{src:t.validateURL,alt:"",width:"76",height:"34",title:"单击重新加载验证码"},on:{click:t.getRandomImage}})])]),o("div",{attrs:{id:"errorcontent"}}),o("div",{staticClass:"loginbutton",on:{click:t.loginAction}},[t._v(" 登录 ")]),o("div",{staticClass:"input-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.uniqueCode,expression:"userInfo.uniqueCode"}],ref:"uniqueCode",staticClass:"loginscan",attrs:{placeholder:"扫码登录",autofocus:""},domProps:{value:t.userInfo.uniqueCode},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loginScan()},input:function(e){e.target.composing||t.$set(t.userInfo,"uniqueCode",e.target.value)}}})])]),o("div",{staticClass:"scanlogin"},[o("div",{staticClass:"main"},[o("div",{staticClass:"main-content"},[o("img",{attrs:{src:t.scanimg,alt:"",id:"scanimg"}}),t._m(0)]),o("div",{staticClass:"loginscan-info"},[t._v(" 打开"),o("a",{attrs:{href:"sysBaseConf.casclient.appInfo.url",target:"_blank",title:t.sysBaseConf.casclient.appInfo.name}},[t._v(t._s(t.sysBaseConf.casclient.appInfo.name))]),t._v("扫一扫登录 ")])])]),t._m(1)]],2)]),o("div",{staticClass:"copyright"},[o("div",{staticClass:"copyright-content"},[o("div",{staticClass:"copyright-left"},[o("img",{attrs:{src:"/sysconf/source/casclient/qrimg.jpg"}})]),o("div",{staticClass:"copyright-right"},[o("a",{attrs:{href:t.sysBaseConf.copyright.namelink,target:"_blank",title:t.sysBaseConf.copyright.name}},[t._v("© "+t._s(t.curYear)+" "+t._s(t.sysBaseConf.copyright.name))]),o("br"),t._v(" "+t._s(t.sysBaseConf.copyright.address)+" "),t.sysBaseConf.copyright.phonehref.length>0?[o("br"),t._v("(0086) "),t._l(t.sysBaseConf.copyright.phonehref,(function(e){return[o("a",{key:e,attrs:{href:"tel:"+e,title:"电话联系我们"+e}},[t._v(" "+t._s(e))])]}))]:t._e(),t.sysBaseConf.copyright.techSupport?[o("br"),o("a",{attrs:{href:t.sysBaseConf.copyright.techSupport.url,target:"_blank"}},[t._v(" "+t._s(t.sysBaseConf.copyright.techSupport.name))]),t._v(" 技术支持 ")]:t._e()],2),o("div",{staticClass:"clearfix"})]),t.sysBaseConf.copyright.beian&&t.sysBaseConf.copyright.beian.length>0?o("div",{staticStyle:{"text-align":"center","margin-top":"15px",color:"#555"}},[t._l(t.sysBaseConf.copyright.beian,(function(e,n){return[o("a",{key:n,attrs:{href:e.url,target:"_blank",title:e.name}},[t._v(" "+t._s(e.name))]),n<t.sysBaseConf.copyright.beian.length-1?o("span",{key:n+"-aa"},[t._v(" |")]):t._e()]}))],2):t._e()]),t.modalInfo.show?o("div",{staticClass:"self-modal"},[o("div",{staticClass:"self-modal_content animated bounceIn"},[o("div",{staticClass:"self-modal_header"},[t._v(" "+t._s(t.modalInfo.title)+" ")]),o("div",{staticClass:"self-modal_body",domProps:{innerHTML:t._s(t.modalInfo.content)}}),o("div",{staticClass:"self-modal_footer"},["alert"==t.modalInfo.type?[o("div",{staticClass:"self-modal_confirm",on:{click:t.modalInfoAlert}},[t._v(" "+t._s(t.modalInfo.okText)+" ")])]:"confirm"==t.modalInfo.type?[o("div",{staticClass:"self-modal_confirm",on:{click:t.modalInfoConfirm}},[t._v(" "+t._s(t.modalInfo.okText)+" ")]),o("div",{staticClass:"self-modal_cancel",on:{click:t.modalInfoCancel}},[t._v(" 取消 ")])]:t._e()],2)])]):t._e()])};e._withStripped=!0;const o={};var n=function(t,e,o,n,s,a,i,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=o,l._compiled=!0),n&&(l.functional=!0),a&&(l._scopeId="data-v-"+a),i?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=c):s&&(c=r?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(t,e){return c.call(e),d(t,e)}}else{var h=l.beforeCreate;l.beforeCreate=h?[].concat(h,c):[c]}return{exports:t,options:l}}({name:"App",data(){var t=this;return{curBannerIndex:0,sysBaseConf:window._sysBaseConf,errorInfo:{show:!0,title:"服务初始化",content:"服务正在初始化"},curYear:(new Date).getFullYear(),scanimg:"",userInfo:{username:"",password:"",loginType:"pcType",checkcode:"",uniqueCode:""},modalInfo:{show:!1,type:"alert",title:"提示",okText:"确认",content:"密码不能为空"},modal:{alert(e){t.modalInfo.type="alert",t._setModalData(e)},confirm(e){t.modalInfo.type="confirm",t._setModalData(e)}},validateURL:"/service_user/login/getIdentifyingCode",isShow:!1}},methods:{getRandomImage(){this.validateURL="/service_user/login/getIdentifyingCode?a="+Math.random(),this.isShow=!0},modalInfoAlert(){this.modalInfo.show=!1,this.modalInfo.onOk()},modalInfoConfirm(){this.modalInfo.show=!1,this.modalInfo.onOk()},modalInfoCancel(){this.modalInfo.show=!1,this.modalInfo.onCancel()},_setModalData(t){"string"==typeof t?(this.modalInfo.title=null,this.modalInfo.content=t):(this.modalInfo.title=t.title,this.modalInfo.content=t.content),this.modalInfo.okText=t.okText||"确认",this.modalInfo.onOk="function"==typeof t.onOk?t.onOk:function(){},this.modalInfo.onCancel="function"==typeof t.onCancel?t.onCancel:function(){},this.modalInfo.show=!0},getNonceStr:function(){return Math.random().toString(36).substr(2,15)},loginScan(){""==this.userInfo.uniqueCode&&(this.$Message.error("用户名不能为空"),this.$refs.uniqueCode.focus()),$.post("/service_user/login/login",{data:JSON.stringify({uniqueCode:this.userInfo.uniqueCode})}).then((t=>{200==t.code?(localStorage.setItem("access_token",t.data.token),this.errorInfo={show:!0,title:"登录成功",content:"正在自动重定向"},this.redirectPage()):this.modal.alert({title:"提示",content:t.msg||"用户名或密码错误"})})).catch((t=>{this.$Message.error("登录异常，请稍候再试！")}))},loginAction(){""==this.userInfo.username?this.modal.alert({title:"提示",content:"用户名不能为空"}):""==this.userInfo.password?this.modal.alert({title:"提示",content:"密码不能为空"}):""==this.userInfo.checkcode&&1==this.isShow?this.modal.alert({title:"提示",content:"验证码不能为空"}):this.loginActionPost()},loginActionPost(){$.post("/service_user/login/login",{data:JSON.stringify({loginName:this.userInfo.username,password:md5(this.userInfo.password),loginType:this.userInfo.loginType,checkcode:this.userInfo.checkcode})}).then((t=>{200==t.code?(localStorage.setItem("access_token",t.data.token),this.errorInfo={show:!0,title:"登录成功",content:"正在自动重定向"},this.redirectPage()):this.modal.alert({title:"提示",content:t.msg||"用户名或密码错误"})}))},GetQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(e);return null!=o?unescape(o[2]):null},redirectPage(){var t=this.GetQueryString("redirecturl"),e=localStorage.getItem("access_token");if(t||(t=_sysBaseConf.navUrl),this.checkUrl(t))try{localStorage.setItem("redirect_time",(new Date).getTime());var o=new URL(t);top.location.href=o.origin+o.pathname+"?token="+e+o.hash}catch(n){console.log(e)}else console.log(e)},checkUrl(t){if(!t)return!1;if(!t.match("http://")&&!t.match("https://"))return!1;try{return new URL(t),!0}catch(e){return!1}},check(){var t=this.GetQueryString("appid"),e=this.GetQueryString("redirecturl");"loginout"==this.GetQueryString("mode")&&localStorage.clear(),t||e?t?this.checkUrl(e)?"syscenter"==t?this.autoLoginFn():$.post("/service_user/login/getDataByAppid?appid="+t).then((t=>{if(200==t.code&&t.data.appid)if("all"==t.data.domain)this.autoLoginFn();else if("string"==typeof t.data.domain){t.data.domain.split(",").find((t=>e.match(t)))?this.autoLoginFn():this.errorInfo={show:!0,title:"无权限的请求",content:"无权限的请求"}}else this.errorInfo={show:!0,title:"无权限的请求",content:"无权限的请求"};else this.errorInfo={show:!0,title:"无权限的请求",content:"无权限的请求"}}),(t=>{this.errorInfo={show:!0,title:"服务异常",content:"服务异常 "+t.status+" "+t.statusText+"<br/>请联系系统管理员"}})):this.errorInfo={show:!0,title:"请求参数有误",content:"redirecturl参数有误"}:this.errorInfo={show:!0,title:"请求参数有误",content:"appid参数有误"}:this.errorInfo={show:!1,title:"",content:""}},autoLoginFn(){localStorage.getItem("access_token")?jQuery.ajax({url:"/service_user/human/getUserInfo",type:"post",dataType:"json",contentType:"application/json",data:{token:localStorage.getItem("access_token")},beforeSend:function(t){t.setRequestHeader("access-token",localStorage.getItem("access_token"))}}).then((t=>{if(this.errorInfo={show:!1,title:"",content:""},200==t.code){var e=localStorage.getItem("redirect_time");if(e)try{curTime-Number(e)<1e4?this.modal.confirm({title:"提示",content:"当前页面多次重定向到业务系统，是否继续前往？<br/>登录用户："+t.data.userName,okText:"继续",onOk:()=>{this.errorInfo={show:!0,title:t.data.userName+"登录成功",content:"正在自动重定向"},this.redirectPage()}}):(this.errorInfo={show:!0,title:t.data.userName+"登录成功",content:"正在自动重定向"},this.redirectPage())}catch(o){this.errorInfo={show:!0,title:t.data.userName+"登录成功",content:"正在自动重定向"},this.redirectPage()}else this.errorInfo={show:!0,title:t.data.userName+"登录成功",content:"正在自动重定向"},this.redirectPage()}}),(t=>{401==JSON.parse(t.responseText).code?(localStorage.clear(),this.errorInfo={show:!1,title:"",content:""}):this.errorInfo={show:!0,title:"服务异常",content:"服务异常 "+t.status+" "+t.statusText+"<br/>请联系系统管理员"}})):this.errorInfo={show:!1,title:"",content:""}},setSeoInfo(){document.title=this.sysBaseConf.name},setBanner(){if(this.sysBaseConf.casclient&&this.sysBaseConf.casclient.banner){var t=this.sysBaseConf.casclient.banner.length;setInterval((()=>{this.curBannerIndex>=t-1?this.curBannerIndex=0:this.curBannerIndex++}),5e3)}}},created(){this.check(),this.setSeoInfo()},watch:{}},e,[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"confirmtext"}},[t._v(" 请确认登录"),o("br"),o("a",{attrs:{href:"javascript:;",id:"backscan"}},[t._v("返回")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"othertool"},[o("div",{staticClass:"tool-item"},[o("a",{attrs:{href:"javascript:;",id:"scan"}},[t._v("扫码登录")])]),o("div",{staticClass:"tool-item"},[o("a",{attrs:{href:"javascript:alert('请联系系统管理员重置密码！');"}},[t._v("忘记密码")])])])}],!1,(function(t){for(let e in o)this[e]=o[e]}),null,null,null).exports;new t({data:()=>({}),render:t=>t(n),methods:{},mounted:function(){},created(){}}).$mount("#app"),Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[o]:("00"+e[o]).substr((""+e[o]).length)));return t};
